String.prototype.insert=function(b,a){if(b>0){return this.substring(0,b)+a+this.substring(b,this.length)}else{return a+this}};var Realmeme={font_size:48,font_family:"Impact",template_index:0,draw_template:false,create_meme:function(l){var a=$("#meme");var g=a.find(".data-template");var d=a.find(".data-upper-caption");var k=a.find(".data-lower-caption");g.attr("src",$("#template").val());d.html($("#upper_caption").val());k.html($("#lower_caption").val());a.css("background-image","url("+g.attr("src")+")");var e=new Image();e.src=g.attr("src");if(e.naturalWidth===0){setTimeout(function(){Realmeme.create_meme(l)},50);return}var c=a[0];var b=c.getContext("2d");if(c.width!=e.naturalWidth||c.height!=e.naturalHeight){c.width=e.naturalWidth;c.height=e.naturalHeight}else{b.clearRect(0,0,c.width,c.height)}if(Realmeme.draw_template){b.drawImage(e,0,0)}b.fillStyle="white";b.strokeStyle="black";b.lineWidth=2.5;b.font=Realmeme.font_size+"px "+Realmeme.font_family;b.textAlign="center";var h=Realmeme.split_lines(d.html().toUpperCase(),b,c.width);var j=Realmeme.split_lines(k.html().toUpperCase(),b,c.width).reverse();for(var f=0;f<h.length;f++){b.fillText(h[f],c.width/2,3+Realmeme.font_size*(f+1),c.width*0.9);b.strokeText(h[f],c.width/2,3+Realmeme.font_size*(f+1),c.width*0.9)}for(var f=0;f<j.length;f++){b.fillText(j[f],c.width/2,c.height-(10+Realmeme.font_size*f),c.width*0.9);b.strokeText(j[f],c.width/2,c.height-(10+Realmeme.font_size*f),c.width*0.9)}if(typeof l==="function"){l()}},split_lines:function(g,c,d){if(c.measureText(g).width<d){return[g]}var f=g.split(" ");var b=[];var a="";while(f.length>0){while(c.measureText(f[0]).width>=d){var e=f[0];f[0]=e.slice(0,-1);if(f.length>1){f[1]=e.slice(-1)+f[1]}else{f.push(e.slice(-1))}}if(c.measureText(a+f[0]).width<d){a+=f.shift()+" "}else{b.push(a);a=""}if(f.length===0){b.push(a)}}return b},prepare_template:function(a){a.click(function(){$("#create-meme-title").text($(this).attr("data-original-title"));$("#template").val($(this).attr("data-src"));Realmeme.create_meme(function(){var c=$("#create-meme-dialog");c.modal({dynamic:true});var e=$("#meme");var d=15;var b=+e.attr("width")+ +(d*2);c.parent().width(b);c.parent().css({marginLeft:-b/2})})});a.tooltip({placement:"bottom"})},page_load:{index:function(){var a=$("#templates").find(".template");a.html("");a.lazyload({container:$(".scroll-container"),data_attribute:"src",load:function(f,e){var d=$(this);d.css("background-image","url("+d.attr("src")+")");d.attr("src","");d.attr("alt","");Realmeme.prepare_template(d)}});$(".suggest-meme .template").tooltip({placement:"bottom"});var c=$("#meme");$("#upper_caption, #lower_caption, #template").on("keyup",function(){Realmeme.create_meme()});$("#template").on("input",function(){var d=$("#template");if(!d.val()){d.val(Realmeme.memes[0]["src"])}});var b=$("#search");b.on("input",function(){var d=$("#search").val();$(".template").each(function(){var e=$(this).attr("title").length>0?$(this).attr("title"):$(this).attr("data-original-title");if(e.search(new RegExp(d,"i"))<0){$(this).fadeOut()}else{$(this).show()}});setTimeout(function(){$(".scroll-container").trigger("scroll")},500)});b.parent().show();$("#create-meme").validate({rules:{upperCaption:{required:"#lower_caption:blank",maxlength:100},lowerCaption:{required:"#upper_caption:blank",maxlength:100}},messages:{upperCaption:{required:""},lowerCaption:{required:""}}})},view:function(){$("#meme-image").lazyload({data_attribute:"src"})}}};$(function(){});